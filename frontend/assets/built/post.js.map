{"version":3,"file":"post.js","sources":["post.js"],"sourcesContent":["// Script for processing html in post.hbs\n\n// Redirect if the post is just a reference to an external blog post\n!function () {\n    let container = document.querySelector('.gh-post-content');\n    let bookmark = container.querySelector(':scope > figure.kg-bookmark-card')\n    // A post which is just a reference to an external article\n    // will contain nothing but the bookmark card.\n    if (bookmark != null && container.children.length === 1) {\n        let url = bookmark.querySelector('a.kg-bookmark-container').href\n        if (url != null) window.location.replace(url);\n    }\n}()\n\n// Resize and add blur effect to images.\n!function () {\n    const images = document.querySelectorAll(\".kg-image-card img\");\n    let wrapperMinAR = getMinAspectRatio()\n    for (let i = 0; i < images.length; i++) {\n        let image = images[i]\n        let lightBoxId = `lightbox__photo__${i}`\n        let imgWrapper = document.createElement(\"div\")\n        imgWrapper.style.backgroundImage = `url(\"${image.currentSrc || image.src}\")`\n        imgWrapper.classList.add(\"group\")\n        let imgW = Number(image.getAttribute(\"width\"))\n        let imgH = Number(image.getAttribute(\"height\"))\n        let imgAR = `${imgW}/${imgH}`\n\n        imgWrapper.style.aspectRatio = Math.max((imgW / imgH), wrapperMinAR).toString()\n        image.style.aspectRatio = `${imgW}/${imgH}`\n        imgWrapper.style.maxHeight = `${imgH}px`\n        image.style.maxWidth = `${imgW}px`\n        image.style.maxHeight = `${imgH}px`\n\n        let container = image.parentElement\n        container.insertBefore(imgWrapper, image.parentElement.firstChild)\n        imgWrapper.append(image)\n        imgWrapper.insertAdjacentHTML(\"afterbegin\", `<span onclick='showLightBox(\"${lightBoxId}\");' class='photo-zoom-handle'><svg width=\"18\" height=\"18\" viewBox=\"0 0 20 20\" fill=\"none\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m19 19-4.35-4.35M9 6v6M6 9h6m5 0A8 8 0 1 1 1 9a8 8 0 0 1 16 0Z\"/></svg></span>`)\n        container.insertAdjacentHTML(\"beforebegin\", `<div class='photo-lightbox' id='${lightBoxId}'><div class=\"group\" style=\"${getZoomImgWrapperStyle(imgW, imgH)}\"><span onclick='closeLightBox(\"${lightBoxId}\");' class='photo-zoom-handle'><svg width=\"18\" height=\"18\" viewBox=\"0 0 20 20\" fill=\"none\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m19 19-4.35-4.35M6 9h6m5 0A8 8 0 1 1 1 9a8 8 0 0 1 16 0Z\"/></svg></span><img src=\"${image.src}\" alt=\"${image.alt}\" style=\"aspect-ratio: ${imgAR}\"/></div></div>`)\n    }\n}();\n\n// Add Copy button to code blocks\n!function () {\n    let codes = document.querySelectorAll('code[class*=\"language-\"]')\n    for (let i = 0; i < codes.length; i++) {\n        let code = codes[i]\n        let pre = code.parentElement\n        if (pre.tagName.toLowerCase() !== 'pre') continue\n\n        let copied = `<span class=\"hide\" id=\"copied\"><span>Copied</span><svg class=\"fill-greenSet dark:fill-greenSet-dark\" width=\"20\" height=\"20\" stroke=\"none\" fill=\"none\"><circle cx=\"10\" cy=\"10\" r=\"10\"/><g clip-path=\"url(#a)\"><path fill=\"#fff\" d=\"M8.438 12.188 6.25 10l-.73.73 2.918 2.916 6.25-6.25-.73-.73-5.52 5.521Z\"/></g><defs><clipPath id=\"a\"><path fill=\"#fff\" d=\"M3.75 3.75h12.5v12.5H3.75z\"/></clipPath></defs></svg></span>`\n        let copy = `<span id=\"copy\" onclick='copyCode(this.parentElement)'><span>Copy</span><svg width=\"22\" height=\"22\" fill=\"none\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9.5 1.003c-.675.009-1.08.048-1.408.215a2 2 0 0 0-.874.874c-.167.328-.206.733-.215 1.408M18.5 1.003c.675.009 1.08.048 1.408.215a2 2 0 0 1 .874.874c.167.328.206.733.215 1.408m0 9c-.009.675-.048 1.08-.215 1.408a2 2 0 0 1-.874.874c-.328.167-.733.206-1.408.215M21 7v2m-8-8h2M4.2 21h7.6c1.12 0 1.68 0 2.108-.218a2 2 0 0 0 .874-.874C15 19.48 15 18.92 15 17.8v-7.6c0-1.12 0-1.68-.218-2.108a2 2 0 0 0-.874-.874C13.48 7 12.92 7 11.8 7H4.2c-1.12 0-1.68 0-2.108.218a2 2 0 0 0-.874.874C1 8.52 1 9.08 1 10.2v7.6c0 1.12 0 1.68.218 2.108a2 2 0 0 0 .874.874C2.52 21 3.08 21 4.2 21Z\"/></svg></span>`\n        pre.insertAdjacentHTML(\"afterbegin\", `<div class=\"code-copy\"><div>${copied}${copy}</div></div>`)\n    }\n}();\n\n// Set click listeners for the back and share buttons.\n!function () {\n    document.getElementById(\"back_icon\").parentElement.href = `${window.location.origin}/blog`\n    document.getElementById(\"post-link-copy\").addEventListener(\"click\", (event) => {\n        let e = event.currentTarget;\n        copy(e, window.location.href, () => {\n            e.classList.toggle(\"copied\")\n        })\n    })\n}();\n\n\nfunction closeLightBox(id) {\n    document.getElementById(id).style.display = \"none\"\n    document.body.style.overflowY = 'auto'\n    document.body.style.overflowX = null\n}\n\nfunction showLightBox(id) {\n    document.getElementById(id).style.display = 'flex'\n    document.body.style.overflowY = 'hidden'\n    document.body.style.overflowX = 'unset'\n}\n\nfunction copyCode(e) {\n    let code = e.parentElement.parentElement.getElementsByTagName('code')[0]\n    let text = code.innerText || code.textContent\n    copy(e, text)\n}\n\nfunction copy(element, text, toggle) {\n    if (element.children[0].className !== 'hide') return\n    navigator.clipboard.writeText(text).then(function () {\n        element.children[0].classList.toggle(\"hide\")\n        element.children[1].classList.toggle(\"hide\")\n        if (typeof toggle === 'function') toggle()\n        setTimeout(() => {\n            element.children[0].classList.toggle(\"hide\")\n            element.children[1].classList.toggle(\"hide\")\n            if (typeof toggle === 'function') toggle()\n        }, 2000);\n    });\n}\n\nfunction getMinAspectRatio() {\n    // 768 is tailwinds md breakpoint: https://tailwindcss.com/docs/responsive-design\n    if ($(window).width() > 768) return 1.5\n    return 0.6\n}\n\nfunction getZoomImgWrapperStyle(imgW, imgH) {\n    let minW = Math.min(imgW, $(window).width())\n    let minH = Math.min(imgH, $(window).height())\n    let style = `aspect-ratio: ${imgW / imgH}; `\n    if (minH > minW) {\n        style += `height: auto; max-height: 100%; width: ${minW}px;`\n    } else {\n        style += `width: auto; max-width: 100%; height: ${minH}px;`\n    }\n    return style\n}\n"],"names":["closeLightBox","id","document","getElementById","style","display","body","overflowY","overflowX","showLightBox","copyCode","e","let","code","parentElement","getElementsByTagName","copy","innerText","textContent","element","text","toggle","children","className","navigator","clipboard","writeText","then","classList","setTimeout","getMinAspectRatio","$","window","width","getZoomImgWrapperStyle","imgW","imgH","minW","Math","min","minH","height","container","querySelector","bookmark","length","url","href","location","replace","images","querySelectorAll","wrapperMinAR","i","image","lightBoxId","imgWrapper","createElement","backgroundImage","currentSrc","src","add","Number","getAttribute","imgAR","aspectRatio","max","toString","maxHeight","maxWidth","insertBefore","firstChild","append","insertAdjacentHTML","alt","codes","pre","tagName","toLowerCase","origin","addEventListener","event","currentTarget"],"mappings":"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"}