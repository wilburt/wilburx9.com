{"version":3,"file":"post.js","sources":["post.js"],"sourcesContent":["// Script for processing html in post.hbs\n\n// Redirect if the post is just a reference to an external blog post\n!function () {\n    let container = $('.gh-post-content');\n    let bookmark = container.find(':first');\n    // A post which is just a reference to an external article\n    // will contain nothing but the bookmark card and the reading time.\n    if (bookmark.length > 0 && container.children.length === 2) {\n        let url = bookmark.find('a.kg-bookmark-container').attr('href');\n        if (url) window.location.replace(url);\n    }\n}()\n\n// Resize and add blur effect to images.\nfunction processImages(primaryTag) {\n    const images = document.querySelectorAll(\".kg-image-card img\");\n    let wrapperMinAR = getMinAspectRatio()\n    for (let i = 0; i < images.length; i++) {\n        let image = images[i]\n        let lightBoxId = `lightbox__photo__${i}`\n        let imgWrapper = document.createElement(\"div\")\n        imgWrapper.style.backgroundImage = `url(\"${image.currentSrc || image.src}\")`\n        imgWrapper.classList.add(\"group\")\n        let imgW = Number(image.getAttribute(\"width\"))\n        let imgH = Number(image.getAttribute(\"height\"))\n        let imgAR = `${imgW}/${imgH}`\n\n        imgWrapper.style.aspectRatio = Math.max((imgW / imgH), wrapperMinAR).toString()\n        image.style.aspectRatio = `${imgW}/${imgH}`\n        imgWrapper.style.maxHeight = `${imgH}px`\n        image.style.maxWidth = `${imgW}px`\n        image.style.maxHeight = `${imgH}px`\n\n        let container = image.parentElement\n        container.insertBefore(imgWrapper, image.parentElement.firstChild)\n        imgWrapper.append(image)\n        if (primaryTag === 'photography') {\n            imgWrapper.insertAdjacentHTML(\"afterbegin\", `<span onclick='showLightBox(\"${lightBoxId}\");' class='photo-zoom-handle'><svg width=\"18\" height=\"18\" viewBox=\"0 0 20 20\" fill=\"none\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m19 19-4.35-4.35M9 6v6M6 9h6m5 0A8 8 0 1 1 1 9a8 8 0 0 1 16 0Z\"/></svg></span>`)\n            container.insertAdjacentHTML(\"beforebegin\", `<div class='photo-lightbox' id='${lightBoxId}'><div class=\"group\" style=\"${getZoomImgWrapperStyle(imgW, imgH)}\"><span onclick='closeLightBox(\"${lightBoxId}\");' class='photo-zoom-handle'><svg width=\"18\" height=\"18\" viewBox=\"0 0 20 20\" fill=\"none\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m19 19-4.35-4.35M6 9h6m5 0A8 8 0 1 1 1 9a8 8 0 0 1 16 0Z\"/></svg></span><img src=\"${image.src}\" alt=\"${image.alt}\" style=\"aspect-ratio: ${imgAR}\"/></div></div>`)\n        }\n    }\n}\n\n// Add Copy button to code blocks\n!function () {\n    let codes = document.querySelectorAll('code[class*=\"language-\"]')\n    for (let i = 0; i < codes.length; i++) {\n        let code = codes[i]\n        let pre = code.parentElement\n        if (pre.tagName.toLowerCase() !== 'pre') continue\n\n        let copied = `<span class=\"hide\" id=\"copied\"><span>Copied</span><svg class=\"fill-greenSet dark:fill-greenSet-dark\" width=\"20\" height=\"20\" stroke=\"none\" fill=\"none\"><circle cx=\"10\" cy=\"10\" r=\"10\"/><g clip-path=\"url(#a)\"><path fill=\"#fff\" d=\"M8.438 12.188 6.25 10l-.73.73 2.918 2.916 6.25-6.25-.73-.73-5.52 5.521Z\"/></g><defs><clipPath id=\"a\"><path fill=\"#fff\" d=\"M3.75 3.75h12.5v12.5H3.75z\"/></clipPath></defs></svg></span>`\n        let copy = `<span id=\"copy\" onclick='copyCode(this.parentElement)'><span>Copy</span><svg width=\"22\" height=\"22\" fill=\"none\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9.5 1.003c-.675.009-1.08.048-1.408.215a2 2 0 0 0-.874.874c-.167.328-.206.733-.215 1.408M18.5 1.003c.675.009 1.08.048 1.408.215a2 2 0 0 1 .874.874c.167.328.206.733.215 1.408m0 9c-.009.675-.048 1.08-.215 1.408a2 2 0 0 1-.874.874c-.328.167-.733.206-1.408.215M21 7v2m-8-8h2M4.2 21h7.6c1.12 0 1.68 0 2.108-.218a2 2 0 0 0 .874-.874C15 19.48 15 18.92 15 17.8v-7.6c0-1.12 0-1.68-.218-2.108a2 2 0 0 0-.874-.874C13.48 7 12.92 7 11.8 7H4.2c-1.12 0-1.68 0-2.108.218a2 2 0 0 0-.874.874C1 8.52 1 9.08 1 10.2v7.6c0 1.12 0 1.68.218 2.108a2 2 0 0 0 .874.874C2.52 21 3.08 21 4.2 21Z\"/></svg></span>`\n        pre.insertAdjacentHTML(\"afterbegin\", `<div class=\"code-copy\"><div>${copied}${copy}</div></div>`)\n    }\n}();\n\n// Set click listeners for the back and share buttons.\n!function () {\n    document.getElementById(\"back_icon\").parentElement.href = `${window.location.origin}/blog`\n    document.getElementById(\"post-link-copy\").addEventListener(\"click\", (event) => {\n        let e = event.currentTarget;\n        copy(e, window.location.href, () => {\n            e.classList.toggle(\"copied\")\n        })\n    })\n}();\n\n\nfunction closeLightBox(id) {\n    document.getElementById(id).style.display = \"none\"\n    document.body.style.overflowY = 'auto'\n    document.body.style.overflowX = null\n}\n\nfunction showLightBox(id) {\n    document.getElementById(id).style.display = 'flex'\n    document.body.style.overflowY = 'hidden'\n    document.body.style.overflowX = 'unset'\n}\n\nfunction copyCode(e) {\n    let code = e.parentElement.parentElement.getElementsByTagName('code')[0]\n    let text = code.innerText || code.textContent\n    copy(e, text)\n}\n\nfunction copy(element, text, toggle) {\n    if (element.children[0].className !== 'hide') return\n    navigator.clipboard.writeText(text).then(function () {\n        element.children[0].classList.toggle(\"hide\")\n        element.children[1].classList.toggle(\"hide\")\n        if (typeof toggle === 'function') toggle()\n        setTimeout(() => {\n            element.children[0].classList.toggle(\"hide\")\n            element.children[1].classList.toggle(\"hide\")\n            if (typeof toggle === 'function') toggle()\n        }, 2000);\n    });\n}\n\nfunction getMinAspectRatio() {\n    // 768 is tailwinds md breakpoint: https://tailwindcss.com/docs/responsive-design\n    if ($(window).width() > 768) return 1.5\n    return 0.6\n}\n\nfunction getZoomImgWrapperStyle(imgW, imgH) {\n    let minW = Math.min(imgW, $(window).width())\n    let minH = Math.min(imgH, $(window).height())\n    let style = `aspect-ratio: ${imgW / imgH}; `\n    if (minH > minW) {\n        style += `height: auto; max-height: 100%; width: ${minW}px;`\n    } else {\n        style += `width: auto; max-width: 100%; height: ${minH}px;`\n    }\n    return style\n}\n"],"names":["processImages","primaryTag","images","document","querySelectorAll","wrapperMinAR","getMinAspectRatio","let","i","length","image","lightBoxId","imgWrapper","createElement","imgW","style","backgroundImage","currentSrc","src","classList","add","Number","getAttribute","imgH","imgAR","container","aspectRatio","Math","max","toString","maxHeight","maxWidth","parentElement","insertBefore","firstChild","append","insertAdjacentHTML","getZoomImgWrapperStyle","alt","closeLightBox","id","getElementById","display","body","overflowY","overflowX","showLightBox","copyCode","e","code","getElementsByTagName","copy","innerText","textContent","element","text","toggle","children","className","navigator","clipboard","writeText","then","setTimeout","$","window","width","minW","min","minH","height","bookmark","find","url","attr","location","replace","codes","pre","tagName","toLowerCase","href","origin","addEventListener","event","currentTarget"],"mappings":"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"}